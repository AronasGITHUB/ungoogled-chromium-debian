---
 tools/gyp/pylib/gyp/generator/scons.py |    6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

Index: src/tools/gyp/pylib/gyp/generator/scons.py
===================================================================
--- src.orig/tools/gyp/pylib/gyp/generator/scons.py
+++ src/tools/gyp/pylib/gyp/generator/scons.py
@@ -462,26 +462,26 @@
 import os
 import sys
 
 def GetProcessorCount():
   '''
   Detects the number of CPUs on the system. Adapted form:
   http://codeliberates.blogspot.com/2008/05/detecting-cpuscores-in-python.html
   '''
+  if os.environ.has_key('NUMBER_OF_PROCESSORS'):
+    return max(int(os.environ.get('NUMBER_OF_PROCESSORS', '1')), 1)
+
   # Linux, Unix and Mac OS X:
   if hasattr(os, 'sysconf'):
     if os.sysconf_names.has_key('SC_NPROCESSORS_ONLN'):
       # Linux and Unix or Mac OS X with python >= 2.5:
       return os.sysconf('SC_NPROCESSORS_ONLN')
     else:  # Mac OS X with Python < 2.5:
       return int(os.popen2("sysctl -n hw.ncpu")[1].read())
-  # Windows:
-  if os.environ.has_key('NUMBER_OF_PROCESSORS'):
-    return max(int(os.environ.get('NUMBER_OF_PROCESSORS', '1')), 1)
   return 1  # Default
 
 # Support PROGRESS= to show progress in different ways.
 p = ARGUMENTS.get('PROGRESS')
 if p == 'spinner':
   Progress(['/\\r', '|\\r', '\\\\\\r', '-\\r'],
            interval=5,
            file=open('/dev/tty', 'w'))
